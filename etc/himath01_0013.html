<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" >
	<meta name="viewport" content="width=device-width, initial-scale=1">
        <title>健康情報数学Ⅰ</title>
        <link rel="stylesheet" href="style.css">
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <!-- mathjax 別立て式を左寄せにする (https://docs.mathjax.org/en/latest/options/output/chtml.html) -->
        <script> MathJax = { 
            chtml: {
                displayAlign: 'left' 
            }
        };</script>
    </head>
    <body>
        <h2>グラムシュミットの手法（3次元ベクトル空間）</h2>
        <a href="toppage.html"> 問題一覧に戻る </a>
        <h3>問題  </h3> 
        <p> \( \mathbf{R}^3 \) の次の基底にグラムシュミットの直交化を適用して正規直交基底を求めなさい.
        	$$
        		\boldsymbol{w}_1 = \begin{pmatrix}1 \\ -1 \\ 1 \end{pmatrix}, \boldsymbol{w}_2 = \begin{pmatrix} 5 \\ -2 \\ -1 \end{pmatrix}, \boldsymbol{w}_3 = \begin{pmatrix}2 \\ 1 \\ 1 \end{pmatrix}
        	$$
        	ここでグラムシュミットの直交化手法は，3次元ベクトル空間\( V \)の任意の基底を \( \{ \boldsymbol{w}_1, \boldsymbol{w}_2, \boldsymbol{w}_3 \} \)とすると，
        </p>
        <ol> 
        	<li> Step 1.
				\begin{align*}
					\boldsymbol{v}_1^{\prime} &= \boldsymbol{w}_1 \\
					\boldsymbol{v}_1 &= \frac{\boldsymbol{v}_1^{\prime}}{\left\|\boldsymbol{v}_1^{\prime}\right\|}
				\end{align*}
        	</li>
        	<li> Step 2.
        		\begin{align*}
					\boldsymbol{v}_2^{\prime} &= \boldsymbol{w}_2-\left(\boldsymbol{w}_2^T \boldsymbol{v}_1\right) \boldsymbol{v}_1 \\
					\boldsymbol{v}_2&=\frac{\boldsymbol{v}_2^{\prime}}{\left\|\boldsymbol{v}_2^{\prime}\right\|}
        		\end{align*}
        	</li>
        	<li> Step 3. 
        		\begin{align*}
        			\boldsymbol{v}_3^{\prime} &= \boldsymbol{w}_3 - \left(\boldsymbol{w}_3^T \boldsymbol{v}_1\right) \boldsymbol{v}_1 - \left(\boldsymbol{w}_3^T \boldsymbol{v}_2\right) \boldsymbol{v}_2 \\
					\boldsymbol{v}_3 &= \frac{\boldsymbol{v}_3^{\prime}}{\left\|\boldsymbol{v}_3^{\prime}\right\|}
        		\end{align*}
        	</li>
        <p>によって\( V \) の正規直交基底 \( \{ \boldsymbol{v}_1, \boldsymbol{v}_2, \boldsymbol{v}_3 \} \) を得る．
        </p>
        </ol>

        <details>
            <summary>クリックして <strong>解答</strong>を見る</summary>
			<p>
				$$
            		\left\{   \begin{pmatrix} \frac{1}{\sqrt{3}} \\ \frac{-1}{\sqrt{3}} \\ \frac{1}{\sqrt{3}}\end{pmatrix},  \begin{pmatrix} \frac{1}{\sqrt{2}} \\ 0 \\ \frac{-1}{\sqrt{2}}\end{pmatrix}, \begin{pmatrix} \frac{1}{\sqrt{6}} \\  \frac{2}{\sqrt{6}} \\ \frac{1}{\sqrt{6}}\end{pmatrix}  \right\}
            	$$
            	または,
            	$$
            		\left\{ \frac{1}{\sqrt{3}} \begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix}, \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix} , \frac{1}{\sqrt{6}} \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix} \right\}
            	$$
            	と答えてもよい.
			</p>
        </details>
        <br>
        <details>
            <summary> クリックして<strong>解説</strong>を見る</summary>
            <ol>
            	<li> Step 1. 
            		最初のベクトル \( \boldsymbol{w}_1\) をそのまま \( \boldsymbol{v}_1^{\prime} \) とします．
            		$$
            			\boldsymbol{v}_1^{\prime} = \begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix}
            		$$
            		ノルムを計算します．
            		$$
            			\|\boldsymbol{v}_1^{\prime}\| = \sqrt{1^2 + (-1)^2 + 1^2 } = \sqrt{1 + 1 + 1} = \sqrt{3}
            		$$
            		よって，
            		\begin{align*}
            			\boldsymbol{v}_1 &= \frac{\boldsymbol{v}_1^{\prime}}{\left\|\boldsymbol{v}_1^{\prime}\right\|}\\
            				&= \frac{1}{\sqrt{3}} \begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix}\\
            				&= \begin{pmatrix} \frac{1}{\sqrt{3}} \\ \frac{-1}{\sqrt{3}} \\ \frac{1}{\sqrt{3}}  \end{pmatrix}
            		\end{align*}
                </li>
                <li> Step 2.
                	$$
                		\boldsymbol{v}_2^{\prime} = \boldsymbol{w}_2 - \left( \boldsymbol{w}_2^T \boldsymbol{v}_1 \right) \boldsymbol{v}_1
                	$$
                	を計算します．まず，この式の \( \boldsymbol{w}_2^T \boldsymbol{v}_1 \)を計算すると，
                	\begin{align*}
                		\boldsymbol{w}_2^T \boldsymbol{v}_1 &= \begin{pmatrix} 5 & -2 & -1 \end{pmatrix} \frac{1}{\sqrt{3}}\begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix} \\
                			&= \frac{1}{\sqrt{3}}\begin{pmatrix} 5 & -2 & -1\end{pmatrix}\begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix}\\
                			&= \frac{1}{\sqrt{3}}\left\{ 5 \times 1 + (-2) \times (-1) + (-1) \times 1  \right\} \\
                			&= \frac{1}{\sqrt{3}}(5 + 2 -1) \\
                			&= \frac{6}{\sqrt{3}}
                	\end{align*}
                	よって，上の式は，
                	\begin{align*}
                		\boldsymbol{v}_2^{\prime} &= \boldsymbol{w}_2 - \frac{6}{\sqrt{3}} \boldsymbol{v}_1 \\
                			&= \begin{pmatrix}5 \\ -2 \\ 1 \end{pmatrix} - \frac{6}{\sqrt{3}} \frac{1}{\sqrt{3}} \begin{pmatrix} 1 \\ -1 \\ 1\end{pmatrix} \\
                			&= \begin{pmatrix}5 \\ -2 \\ -1 \end{pmatrix} -2 \begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix} \\
                			&= \begin{pmatrix}3 \\ 0 \\ -3 \end{pmatrix}
                	\end{align*}
                	ノルムを計算すると,  
                	\begin{align*}
                		\|\boldsymbol{v}_2^{\prime}\| &= \sqrt{3^2 + 0 + 3^2} \\
                			&= \sqrt{18} \\
                			&= 3 \sqrt{2}
                	\end{align*}
                	よって，
                	\begin{align*}
                		\boldsymbol{v}_2 &= \frac{1}{3 \sqrt{2}}\boldsymbol{v}_2^{\prime} \\
                			&= \frac{1}{3\sqrt{2}} \begin{pmatrix} 3 \\ 0\\ -3 \end{pmatrix}\\
                			&= \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 0\\ -1 \end{pmatrix}\\
                			&= \begin{pmatrix} \frac{1}{\sqrt{2}} \\ 0 \\ \frac{-1}{\sqrt{2}}  \end{pmatrix}
                	\end{align*}
                </li>
                <li> Step 3.
                	$$
                		\boldsymbol{v}_3^{\prime} = \boldsymbol{w}_3 - \left( \boldsymbol{w}_3^T \boldsymbol{v}_1 \right) \boldsymbol{v}_1- \left( \boldsymbol{w}_3^T \boldsymbol{v}_2 \right) \boldsymbol{v}_2
                	$$
                	を計算します．まず，この式の \( \boldsymbol{w}_3^T \boldsymbol{v}_1, \boldsymbol{w}_3^T \boldsymbol{v}_2 \)を計算すると，
                	\begin{align*}
                		\boldsymbol{w}_3^T \boldsymbol{v}_1 &= \begin{pmatrix} 2 & 1 & 1 \end{pmatrix} \frac{1}{\sqrt{3}}\begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix} \\
                			&= \frac{1}{\sqrt{3}}\begin{pmatrix} 2 & 1 & 1\end{pmatrix}\begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix}\\
                			&= \frac{1}{\sqrt{3}}(2 -1 +1) \\
                			&= \frac{2}{\sqrt{3}}\\
                		\boldsymbol{w}_3^T \boldsymbol{v}_2 &= \begin{pmatrix} 2 & 1 & 1 \end{pmatrix} \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix} \\
                			&= \frac{1}{\sqrt{2}}\begin{pmatrix} 2 & 1 & 1\end{pmatrix}\begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix}\\
                			&= \frac{1}{\sqrt{2}}(2 +0 -1) \\
                			&= \frac{1}{\sqrt{2}}
                	\end{align*}
                	よって，上の式は，
                	\begin{align*}
                		\boldsymbol{v}_3^{\prime} &= \boldsymbol{w}_3 - \frac{2}{\sqrt{3}} \boldsymbol{v}_1- \frac{1}{\sqrt{2}} \boldsymbol{v}_2 \\
                			&= \begin{pmatrix}2 \\ 1 \\ 1 \end{pmatrix} - \frac{2}{\sqrt{3}} \frac{1}{\sqrt{3}} \begin{pmatrix} 1 \\ -1 \\ 1\end{pmatrix} - \frac{1}{\sqrt{2}} \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 0 \\ -1\end{pmatrix} \\
                			&= \begin{pmatrix}2 \\ 1 \\ 1 \end{pmatrix} - \frac{2}{3} \begin{pmatrix} 1 \\ -1 \\ 1 \end{pmatrix} -  \frac{1}{2} \begin{pmatrix} 1 \\ 0 \\ -1\end{pmatrix}\\
                			&= \begin{pmatrix}2 - \frac{2}{3} -\frac{1}{2} \\ 1 + \frac{2}{3} + 0 \\ 1 - \frac{2}{3} + \frac{1}{2} \end{pmatrix}\\
                			&= \frac{1}{6}\begin{pmatrix}5 \\ 10 \\ 5 \end{pmatrix}
                	\end{align*}
                	ノルムを計算すると,  
                	\begin{align*}
                		\|\boldsymbol{v}_3^{\prime}\| &= \sqrt{\frac{1}{6^2} \left( 5^2 + 10^2 + 5^2 \right) } \\
                			&= \sqrt{\frac{5^2}{6^2} \left( 1 + 4 + 1 \right) }  \\
                			&= \frac{5}{6} \sqrt{6}\\
                			&= \frac{5}{\sqrt{6}}
                	\end{align*}
                	よって, 
                	\begin{align*}
                		\boldsymbol{v}_3 &= \frac{\sqrt{6}}{5}\boldsymbol{v}_3^{\prime} \\
                			&= \frac{\sqrt{6}}{5} \frac{1}{6}\begin{pmatrix}5 \\ 10 \\ 5 \end{pmatrix} \\
                			&= \frac{1}{\sqrt{6}} \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix}\\
                			&= \begin{pmatrix} \frac{1}{\sqrt{6}} \\ \frac{2}{\sqrt{6}} \\ \frac{1}{\sqrt{6}}  \end{pmatrix}
                	\end{align*}
                </li>
            </ol>
    </body>
    
</html>
